var yt=Object.defineProperty;var gt=Object.defineProperties;var vt=Object.getOwnPropertyDescriptors;var Re=Object.getOwnPropertySymbols;var wt=Object.prototype.hasOwnProperty;var At=Object.prototype.propertyIsEnumerable;var Le=(r,e)=>{if(e=Symbol[r])return e;throw Error("Symbol."+r+" is not defined")};var he=(r,e,t)=>e in r?yt(r,e,{enumerable:true,configurable:true,writable:true,value:t}):r[e]=t;var C=(r,e)=>{for(var t in e||(e={}))if(wt.call(e,t))he(r,t,e[t]);if(Re)for(var t of Re(e)){if(At.call(e,t))he(r,t,e[t])}return r};var pe=(r,e)=>gt(r,vt(e));var Ve=(r,e,t)=>{he(r,typeof e!=="symbol"?e+"":e,t);return t};var R=(r,e,t)=>{return new Promise((s,n)=>{var i=c=>{try{a(t.next(c))}catch(u){n(u)}};var o=c=>{try{a(t.throw(c))}catch(u){n(u)}};var a=c=>c.done?s(c.value):Promise.resolve(c.value).then(i,o);a((t=t.apply(r,e)).next())})};var de=(r,e,t)=>(e=r[Le("asyncIterator")])?e.call(r):(r=r[Le("iterator")](),e={},t=(s,n)=>(n=r[s])&&(e[s]=i=>new Promise((o,a,c)=>(i=n.call(r,i),c=i.done,Promise.resolve(i.value).then(u=>o({value:u,done:c}),a)))),t("next"),t("return"),e);var J=globalThis;var se=J.trustedTypes;var qe=se?se.createPolicy("lit-html",{createHTML:r=>r}):void 0;var Ze="$lit$";var T=`lit$${(Math.random()+"").slice(9)}$`;var Ye="?"+T;var xt=`<${Ye}>`;var M=document;var X=()=>M.createComment("");var G=r=>null===r||"object"!=typeof r&&"function"!=typeof r;var Ke=Array.isArray;var $t=r=>Ke(r)||"function"==typeof(r==null?void 0:r[Symbol.iterator]);var _e="[ 	\n\f\r]";var Q=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g;var We=/-->/g;var Be=/>/g;var D=RegExp(`>|${_e}(?:([^\\s"'>=/]+)(${_e}*=${_e}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g");var Qe=/'/g;var Je=/"/g;var et=/^(?:script|style|textarea|title)$/i;var tt=r=>(e,...t)=>({_$litType$:r,strings:e,values:t});var rt=tt(1);var Et=tt(2);var Z=Symbol.for("lit-noChange");var d=Symbol.for("lit-nothing");var Xe=new WeakMap;var N=M.createTreeWalker(M,129);function st(r,e){if(!Array.isArray(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==qe?qe.createHTML(e):e}var St=(r,e)=>{const t=r.length-1,s=[];let n,i=2===e?"<svg>":"",o=Q;for(let a=0;a<t;a++){const c=r[a];let u,f,l=-1,h=0;for(;h<c.length&&(o.lastIndex=h,f=o.exec(c),null!==f);)h=o.lastIndex,o===Q?"!--"===f[1]?o=We:void 0!==f[1]?o=Be:void 0!==f[2]?(et.test(f[2])&&(n=RegExp("</"+f[2],"g")),o=D):void 0!==f[3]&&(o=D):o===D?">"===f[0]?(o=n!=null?n:Q,l=-1):void 0===f[1]?l=-2:(l=o.lastIndex-f[2].length,u=f[1],o=void 0===f[3]?D:'"'===f[3]?Je:Qe):o===Je||o===Qe?o=D:o===We||o===Be?o=Q:(o=D,n=void 0);const _=o===D&&r[a+1].startsWith("/>")?" ":"";i+=o===Q?c+xt:l>=0?(s.push(u),c.slice(0,l)+Ze+c.slice(l)+T+_):c+T+(-2===l?a:_)}return[st(r,i+(r[t]||"<?>")+(2===e?"</svg>":"")),s]};var Y=class r{constructor({strings:e,_$litType$:t},s){let n;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[u,f]=St(e,t);if(this.el=r.createElement(u,s),N.currentNode=this.el.content,2===t){const l=this.el.content.firstChild;l.replaceWith(...l.childNodes)}for(;null!==(n=N.nextNode())&&c.length<a;){if(1===n.nodeType){if(n.hasAttributes())for(const l of n.getAttributeNames())if(l.endsWith(Ze)){const h=f[o++],_=n.getAttribute(l).split(T),$=/([.?@])?(.*)/.exec(h);c.push({type:1,index:i,name:$[2],strings:_,ctor:"."===$[1]?ye:"?"===$[1]?ge:"@"===$[1]?ve:V}),n.removeAttribute(l)}else l.startsWith(T)&&(c.push({type:6,index:i}),n.removeAttribute(l));if(et.test(n.tagName)){const l=n.textContent.split(T),h=l.length-1;if(h>0){n.textContent=se?se.emptyScript:"";for(let _=0;_<h;_++)n.append(l[_],X()),N.nextNode(),c.push({type:2,index:++i});n.append(l[h],X())}}}else if(8===n.nodeType)if(n.data===Ye)c.push({type:2,index:i});else{let l=-1;for(;-1!==(l=n.data.indexOf(T,l+1));)c.push({type:7,index:i}),l+=T.length-1}i++}}static createElement(e,t){const s=M.createElement("template");return s.innerHTML=e,s}};function L(r,e,t=r,s){var o,a,c;if(e===Z)return e;let n=void 0!==s?(o=t._$Co)==null?void 0:o[s]:t._$Cl;const i=G(e)?void 0:e._$litDirective$;return(n==null?void 0:n.constructor)!==i&&((a=n==null?void 0:n._$AO)==null?void 0:a.call(n,false),void 0===i?n=void 0:(n=new i(r),n._$AT(r,t,s)),void 0!==s?((c=t._$Co)!=null?c:t._$Co=[])[s]=n:t._$Cl=n),void 0!==n&&(e=L(r,n._$AS(r,e.values),n,s)),e}var be=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){var u;const{el:{content:t},parts:s}=this._$AD,n=((u=e==null?void 0:e.creationScope)!=null?u:M).importNode(t,true);N.currentNode=n;let i=N.nextNode(),o=0,a=0,c=s[0];for(;void 0!==c;){if(o===c.index){let f;2===c.type?f=new K(i,i.nextSibling,this,e):1===c.type?f=new c.ctor(i,c.name,c.strings,this,e):6===c.type&&(f=new we(i,this,e)),this._$AV.push(f),c=s[++a]}o!==(c==null?void 0:c.index)&&(i=N.nextNode(),o++)}return N.currentNode=M,n}p(e){let t=0;for(const s of this._$AV)void 0!==s&&(void 0!==s.strings?(s._$AI(e,s,t),t+=s.strings.length-2):s._$AI(e[t])),t++}};var K=class r{get _$AU(){var e,t;return(t=(e=this._$AM)==null?void 0:e._$AU)!=null?t:this._$Cv}constructor(e,t,s,n){var i;this.type=2,this._$AH=d,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=s,this.options=n,this._$Cv=(i=n==null?void 0:n.isConnected)!=null?i:true}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===(e==null?void 0:e.nodeType)&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=L(this,e,t),G(e)?e===d||null==e||""===e?(this._$AH!==d&&this._$AR(),this._$AH=d):e!==this._$AH&&e!==Z&&this._(e):void 0!==e._$litType$?this.g(e):void 0!==e.nodeType?this.$(e):$t(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==d&&G(this._$AH)?this._$AA.nextSibling.data=e:this.$(M.createTextNode(e)),this._$AH=e}g(e){var i;const{values:t,_$litType$:s}=e,n="number"==typeof s?this._$AC(e):(void 0===s.el&&(s.el=Y.createElement(st(s.h,s.h[0]),this.options)),s);if(((i=this._$AH)==null?void 0:i._$AD)===n)this._$AH.p(t);else{const o=new be(n,this),a=o.u(this.options);o.p(t),this.$(a),this._$AH=o}}_$AC(e){let t=Xe.get(e.strings);return void 0===t&&Xe.set(e.strings,t=new Y(e)),t}T(e){Ke(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let s,n=0;for(const i of e)n===t.length?t.push(s=new r(this.k(X()),this.k(X()),this,this.options)):s=t[n],s._$AI(i),n++;n<t.length&&(this._$AR(s&&s._$AB.nextSibling,n),t.length=n)}_$AR(e=this._$AA.nextSibling,t){var s;for((s=this._$AP)==null?void 0:s.call(this,false,true,t);e&&e!==this._$AB;){const n=e.nextSibling;e.remove(),e=n}}setConnected(e){var t;void 0===this._$AM&&(this._$Cv=e,(t=this._$AP)==null?void 0:t.call(this,e))}};var V=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,s,n,i){this.type=1,this._$AH=d,this._$AN=void 0,this.element=e,this.name=t,this._$AM=n,this.options=i,s.length>2||""!==s[0]||""!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=d}_$AI(e,t=this,s,n){const i=this.strings;let o=false;if(void 0===i)e=L(this,e,t,0),o=!G(e)||e!==this._$AH&&e!==Z,o&&(this._$AH=e);else{const a=e;let c,u;for(e=i[0],c=0;c<i.length-1;c++)u=L(this,a[s+c],t,c),u===Z&&(u=this._$AH[c]),o||(o=!G(u)||u!==this._$AH[c]),u===d?e=d:e!==d&&(e+=(u!=null?u:"")+i[c+1]),this._$AH[c]=u}o&&!n&&this.j(e)}j(e){e===d?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e!=null?e:"")}};var ye=class extends V{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===d?void 0:e}};var ge=class extends V{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==d)}};var ve=class extends V{constructor(e,t,s,n,i){super(e,t,s,n,i),this.type=5}_$AI(e,t=this){var o;if((e=(o=L(this,e,t,0))!=null?o:d)===Z)return;const s=this._$AH,n=e===d&&s!==d||e.capture!==s.capture||e.once!==s.once||e.passive!==s.passive,i=e!==d&&(s===d||n);n&&this.element.removeEventListener(this.name,this,s),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,s;"function"==typeof this._$AH?this._$AH.call((s=(t=this.options)==null?void 0:t.host)!=null?s:this.element,e):this._$AH.handleEvent(e)}};var we=class{constructor(e,t,s){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(e){L(this,e)}};var me=J.litHtmlPolyfillSupport;var Ge;me==null?void 0:me(Y,K),((Ge=J.litHtmlVersions)!=null?Ge:J.litHtmlVersions=[]).push("3.0.0");var Ae=(r,e,t)=>{var i,o;const s=(i=t==null?void 0:t.renderBefore)!=null?i:e;let n=s._$litPart$;if(void 0===n){const a=(o=t==null?void 0:t.renderBefore)!=null?o:null;s._$litPart$=n=new K(e.insertBefore(X(),a),a,void 0,t!=null?t:{})}return n._$AI(r),n};var Ot={data:""};var Pt=r=>"object"==typeof window?((r?r.querySelector("#_goober"):window._goober)||Object.assign((r||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:r||Ot;var Ct=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g;var Tt=/\/\*[^]*?\*\/|  +/g;var nt=/\n+/g;var I=(r,e)=>{let t="",s="",n="";for(let i in r){let o=r[i];"@"==i[0]?"i"==i[1]?t=i+" "+o+";":s+="f"==i[1]?I(o,i):i+"{"+I(o,"k"==i[1]?"":e)+"}":"object"==typeof o?s+=I(o,e?e.replace(/([^,])+/g,a=>i.replace(/(^:.*)|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,a):a?a+" "+c:c)):i):null!=o&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=I.p?I.p(i,o):i+":"+o+";")}return t+(e&&n?e+"{"+n+"}":n)+s};var P={};var it=r=>{if("object"==typeof r){let e="";for(let t in r)e+=t+it(r[t]);return e}return r};var jt=(r,e,t,s,n)=>{let i=it(r),o=P[i]||(P[i]=(c=>{let u=0,f=11;for(;u<c.length;)f=101*f+c.charCodeAt(u++)>>>0;return"go"+f})(i));if(!P[o]){let c=i!==r?r:(u=>{let f,l,h=[{}];for(;f=Ct.exec(u.replace(Tt,""));)f[4]?h.shift():f[3]?(l=f[3].replace(nt," ").trim(),h.unshift(h[0][l]=h[0][l]||{})):h[0][f[1]]=f[2].replace(nt," ").trim();return h[0]})(r);P[o]=I(n?{["@keyframes "+o]:c}:c,t?"":"."+o)}let a=t&&P.g?P.g:null;return t&&(P.g=P[o]),((c,u,f,l)=>{l?u.data=u.data.replace(l,c):-1===u.data.indexOf(c)&&(u.data=f?c+u.data:u.data+c)})(P[o],e,s,a),o};var Dt=(r,e,t)=>r.reduce((s,n,i)=>{let o=e[i];if(o&&o.call){let a=o(t),c=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=c?"."+c:a&&"object"==typeof a?a.props?"":I(a,""):false===a?"":a}return s+n+(null==o?"":o)},"");function xe(r){let e=this||{},t=r.call?r(e.p):r;return jt(t.unshift?t.raw?Dt(t,[].slice.call(arguments,1),e.p):t.reduce((s,n)=>Object.assign(s,n&&n.call?n(e.p):n),{}):t,Pt(e.target),e.g,e.o,e.k)}var Jt=xe.bind({g:1});var Xt=xe.bind({k:1});var ft=Symbol.for("immer-nothing");var ot=Symbol.for("immer-draftable");var b=Symbol.for("immer-state");var Nt=true?[function(r){return`The plugin for '${r}' has not been loaded into Immer. To enable the plugin, import and call \`enable${r}()\` when initializing your application.`},function(r){return`produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${r}'`},"This object has been frozen and should not be mutated",function(r){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+r},"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.","Immer forbids circular references","The first or second argument to `produce` must be a function","The third argument to `produce` must be a function or undefined","First argument to `createDraft` must be a plain object, an array, or an immerable object","First argument to `finishDraft` must be a draft returned by `createDraft`",function(r){return`'current' expects a draft, got: ${r}`},"Object.defineProperty() cannot be used on an Immer draft","Object.setPrototypeOf() cannot be used on an Immer draft","Immer only supports deleting array indices","Immer only supports setting array indices and the 'length' property",function(r){return`'original' expects a draft, got: ${r}`}]:[];function m(r,...e){if(true){const t=Nt[r];const s=typeof t==="function"?t.apply(null,e):t;throw new Error(`[Immer] ${s}`)}throw new Error(`[Immer] minified error nr: ${r}. Full error at: https://bit.ly/3cXEKWf`)}var q=Object.getPrototypeOf;function W(r){return!!r&&!!r[b]}function F(r){var e;if(!r)return false;return ht(r)||Array.isArray(r)||!!r[ot]||!!((e=r.constructor)==null?void 0:e[ot])||ae(r)||ce(r)}var Mt=Object.prototype.constructor.toString();function ht(r){if(!r||typeof r!=="object")return false;const e=q(r);if(e===null){return true}const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return true;return typeof t=="function"&&Function.toString.call(t)===Mt}function ee(r,e){if(oe(r)===0){Object.entries(r).forEach(([t,s])=>{e(t,s,r)})}else{r.forEach((t,s)=>e(s,t,r))}}function oe(r){const e=r[b];return e?e.type_:Array.isArray(r)?1:ae(r)?2:ce(r)?3:0}function Se(r,e){return oe(r)===2?r.has(e):Object.prototype.hasOwnProperty.call(r,e)}function pt(r,e,t){const s=oe(r);if(s===2)r.set(e,t);else if(s===3){r.add(t)}else r[e]=t}function It(r,e){if(r===e){return r!==0||1/r===1/e}else{return r!==r&&e!==e}}function ae(r){return r instanceof Map}function ce(r){return r instanceof Set}function z(r){return r.copy_||r.base_}function Oe(r,e){if(ae(r)){return new Map(r)}if(ce(r)){return new Set(r)}if(Array.isArray(r))return Array.prototype.slice.call(r);if(!e&&ht(r)){if(!q(r)){const n=Object.create(null);return Object.assign(n,r)}return C({},r)}const t=Object.getOwnPropertyDescriptors(r);delete t[b];let s=Reflect.ownKeys(t);for(let n=0;n<s.length;n++){const i=s[n];const o=t[i];if(o.writable===false){o.writable=true;o.configurable=true}if(o.get||o.set)t[i]={configurable:true,writable:true,enumerable:o.enumerable,value:r[i]}}return Object.create(q(r),t)}function De(r,e=false){if(ue(r)||W(r)||!F(r))return r;if(oe(r)>1){r.set=r.add=r.clear=r.delete=zt}Object.freeze(r);if(e)ee(r,(t,s)=>De(s,true),true);return r}function zt(){m(2)}function ue(r){return Object.isFrozen(r)}var Ft={};function H(r){const e=Ft[r];if(!e){m(0,r)}return e}var te;function dt(){return te}function Ht(r,e){return{drafts_:[],parent_:r,immer_:e,canAutoFreeze_:true,unfinalizedDrafts_:0}}function at(r,e){if(e){H("Patches");r.patches_=[];r.inversePatches_=[];r.patchListener_=e}}function Pe(r){Ce(r);r.drafts_.forEach(Ut);r.drafts_=null}function Ce(r){if(r===te){te=r.parent_}}function ct(r){return te=Ht(te,r)}function Ut(r){const e=r[b];if(e.type_===0||e.type_===1)e.revoke_();else e.revoked_=true}function ut(r,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];const s=r!==void 0&&r!==t;if(s){if(t[b].modified_){Pe(e);m(4)}if(F(r)){r=ne(e,r);if(!e.parent_)ie(e,r)}if(e.patches_){H("Patches").generateReplacementPatches_(t[b].base_,r,e.patches_,e.inversePatches_)}}else{r=ne(e,t,[])}Pe(e);if(e.patches_){e.patchListener_(e.patches_,e.inversePatches_)}return r!==ft?r:void 0}function ne(r,e,t){if(ue(e))return e;const s=e[b];if(!s){ee(e,(n,i)=>lt(r,s,e,n,i,t),true);return e}if(s.scope_!==r)return e;if(!s.modified_){ie(r,s.base_,true);return s.base_}if(!s.finalized_){s.finalized_=true;s.scope_.unfinalizedDrafts_--;const n=s.copy_;let i=n;let o=false;if(s.type_===3){i=new Set(n);n.clear();o=true}ee(i,(a,c)=>lt(r,s,n,a,c,t,o));ie(r,n,false);if(t&&r.patches_){H("Patches").generatePatches_(s,t,r.patches_,r.inversePatches_)}}return s.copy_}function lt(r,e,t,s,n,i,o){if(n===t)m(5);if(W(n)){const a=i&&e&&e.type_!==3&&!Se(e.assigned_,s)?i.concat(s):void 0;const c=ne(r,n,a);pt(t,s,c);if(W(c)){r.canAutoFreeze_=false}else return}else if(o){t.add(n)}if(F(n)&&!ue(n)){if(!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1){return}ne(r,n);if(!e||!e.scope_.parent_)ie(r,n)}}function ie(r,e,t=false){if(!r.parent_&&r.immer_.autoFreeze_&&r.canAutoFreeze_){De(e,t)}}function kt(r,e){const t=Array.isArray(r);const s={type_:t?1:0,scope_:e?e.scope_:dt(),modified_:false,finalized_:false,assigned_:{},parent_:e,base_:r,draft_:null,copy_:null,revoke_:null,isManual_:false};let n=s;let i=Ne;if(t){n=[s];i=re}const{revoke:o,proxy:a}=Proxy.revocable(n,i);s.draft_=a;s.revoke_=o;return a}var Ne={get(r,e){if(e===b)return r;const t=z(r);if(!Se(t,e)){return Rt(r,t,e)}const s=t[e];if(r.finalized_||!F(s)){return s}if(s===$e(r.base_,e)){Ee(r);return r.copy_[e]=je(s,r)}return s},has(r,e){return e in z(r)},ownKeys(r){return Reflect.ownKeys(z(r))},set(r,e,t){const s=_t(z(r),e);if(s==null?void 0:s.set){s.set.call(r.draft_,t);return true}if(!r.modified_){const n=$e(z(r),e);const i=n==null?void 0:n[b];if(i&&i.base_===t){r.copy_[e]=t;r.assigned_[e]=false;return true}if(It(t,n)&&(t!==void 0||Se(r.base_,e)))return true;Ee(r);Te(r)}if(r.copy_[e]===t&&(t!==void 0||e in r.copy_)||Number.isNaN(t)&&Number.isNaN(r.copy_[e]))return true;r.copy_[e]=t;r.assigned_[e]=true;return true},deleteProperty(r,e){if($e(r.base_,e)!==void 0||e in r.base_){r.assigned_[e]=false;Ee(r);Te(r)}else{delete r.assigned_[e]}if(r.copy_){delete r.copy_[e]}return true},getOwnPropertyDescriptor(r,e){const t=z(r);const s=Reflect.getOwnPropertyDescriptor(t,e);if(!s)return s;return{writable:true,configurable:r.type_!==1||e!=="length",enumerable:s.enumerable,value:t[e]}},defineProperty(){m(11)},getPrototypeOf(r){return q(r.base_)},setPrototypeOf(){m(12)}};var re={};ee(Ne,(r,e)=>{re[r]=function(){arguments[0]=arguments[0][0];return e.apply(this,arguments)}});re.deleteProperty=function(r,e){if(isNaN(parseInt(e)))m(13);return re.set.call(this,r,e,void 0)};re.set=function(r,e,t){if(e!=="length"&&isNaN(parseInt(e)))m(14);return Ne.set.call(this,r[0],e,t,r[0])};function $e(r,e){const t=r[b];const s=t?z(t):r;return s[e]}function Rt(r,e,t){var n;const s=_t(e,t);return s?`value`in s?s.value:(n=s.get)==null?void 0:n.call(r.draft_):void 0}function _t(r,e){if(!(e in r))return void 0;let t=q(r);while(t){const s=Object.getOwnPropertyDescriptor(t,e);if(s)return s;t=q(t)}return void 0}function Te(r){if(!r.modified_){r.modified_=true;if(r.parent_){Te(r.parent_)}}}function Ee(r){if(!r.copy_){r.copy_=Oe(r.base_,r.scope_.immer_.useStrictShallowCopy_)}}var Lt=class{constructor(r){this.autoFreeze_=true;this.useStrictShallowCopy_=false;this.produce=(e,t,s)=>{if(typeof e==="function"&&typeof t!=="function"){const i=t;t=e;const o=this;return function a(c=i,...u){return o.produce(c,f=>t.call(this,f,...u))}}if(typeof t!=="function")m(6);if(s!==void 0&&typeof s!=="function")m(7);let n;if(F(e)){const i=ct(this);const o=je(e,void 0);let a=true;try{n=t(o);a=false}finally{if(a)Pe(i);else Ce(i)}at(i,s);return ut(n,i)}else if(!e||typeof e!=="object"){n=t(e);if(n===void 0)n=e;if(n===ft)n=void 0;if(this.autoFreeze_)De(n,true);if(s){const i=[];const o=[];H("Patches").generateReplacementPatches_(e,n,i,o);s(i,o)}return n}else m(1,e)};this.produceWithPatches=(e,t)=>{if(typeof e==="function"){return(o,...a)=>this.produceWithPatches(o,c=>e(c,...a))}let s,n;const i=this.produce(e,t,(o,a)=>{s=o;n=a});return[i,s,n]};if(typeof(r==null?void 0:r.autoFreeze)==="boolean")this.setAutoFreeze(r.autoFreeze);if(typeof(r==null?void 0:r.useStrictShallowCopy)==="boolean")this.setUseStrictShallowCopy(r.useStrictShallowCopy)}createDraft(r){if(!F(r))m(8);if(W(r))r=Vt(r);const e=ct(this);const t=je(r,void 0);t[b].isManual_=true;Ce(e);return t}finishDraft(r,e){const t=r&&r[b];if(!t||!t.isManual_)m(9);const{scope_:s}=t;at(s,e);return ut(void 0,s)}setAutoFreeze(r){this.autoFreeze_=r}setUseStrictShallowCopy(r){this.useStrictShallowCopy_=r}applyPatches(r,e){let t;for(t=e.length-1;t>=0;t--){const n=e[t];if(n.path.length===0&&n.op==="replace"){r=n.value;break}}if(t>-1){e=e.slice(t+1)}const s=H("Patches").applyPatches_;if(W(r)){return s(r,e)}return this.produce(r,n=>s(n,e))}};function je(r,e){const t=ae(r)?H("MapSet").proxyMap_(r,e):ce(r)?H("MapSet").proxySet_(r,e):kt(r,e);const s=e?e.scope_:dt();s.drafts_.push(t);return t}function Vt(r){if(!W(r))m(10,r);return mt(r)}function mt(r){if(!F(r)||ue(r))return r;const e=r[b];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=true;t=Oe(r,e.scope_.immer_.useStrictShallowCopy_)}else{t=Oe(r,true)}ee(t,(s,n)=>{pt(t,s,mt(n))});if(e){e.finalized_=false}return t}var y=new Lt;var U=y.produce;var Zt=y.produceWithPatches.bind(y);var Yt=y.setAutoFreeze.bind(y);var Kt=y.setUseStrictShallowCopy.bind(y);var er=y.applyPatches.bind(y);var tr=y.createDraft.bind(y);var rr=y.finishDraft.bind(y);var Me=class{constructor(e){if(typeof e==="function"){this.observer={next:e}}else{this.observer=e}this.teardowns=[];if(typeof AbortController!=="undefined"){this.controller=new AbortController;this.signal=this.controller.signal}this.isUnsubscribed=false}next(e){if(!this.isUnsubscribed&&this.observer.next){this.observer.next(e)}}complete(){if(!this.isUnsubscribed){if(this.observer.complete){this.observer.complete()}this.unsubscribe()}}error(e){if(!this.isUnsubscribed){if(this.observer.error){this.observer.error(e)}this.unsubscribe()}}addTeardown(e){this.teardowns.push(e)}unsubscribe(){if(!this.isUnsubscribed){this.isUnsubscribed=true;if(this.controller){this.controller.abort()}this.teardowns.forEach(e=>{if(typeof e!=="function"){throw new Error("[Cami.js] Teardown must be a function. Please implement a teardown function in your subscriber.")}e()})}}};var g=class{constructor(e=()=>()=>{}){this._observers=[];this.subscribeCallback=e}subscribe(e=()=>{},t=()=>{},s=()=>{}){let n;if(typeof e==="function"){n={next:e,error:t,complete:s}}else if(typeof e==="object"){n=e}else{throw new Error("[Cami.js] First argument to subscribe must be a next callback or an observer object")}const i=new Me(n);let o=()=>{};try{o=this.subscribeCallback(i)}catch(a){if(i.error){i.error(a)}else{console.error("[Cami.js] Error in Subscriber:",a)}return}i.addTeardown(o);this._observers.push(i);return{unsubscribe:()=>i.unsubscribe(),complete:()=>i.complete(),error:a=>i.error(a)}}next(e){this._observers.forEach(t=>{t.next(e)})}error(e){this._observers.forEach(t=>{t.error(e)})}complete(){this._observers.forEach(e=>{e.complete()})}onValue(e){return this.subscribe({next:e})}onError(e){return this.subscribe({error:e})}onEnd(e){return this.subscribe({complete:e})}[Symbol.asyncIterator](){let e;let t;let s=new Promise(n=>t=n);e={next:n=>{t({value:n,done:false});s=new Promise(i=>t=i)},complete:()=>{t({done:true})},error:n=>{throw n}};this.subscribe(e);return{next:()=>s}}};var k=class extends g{constructor(e){if(typeof e!=="object"||e===null){throw new TypeError("[Cami.js] initialState must be an object")}super(t=>{this._subscriber=t;return()=>{this._subscriber=null}});this.state=new Proxy(e,{get:(t,s)=>{return t[s]},set:(t,s,n)=>{t[s]=n;this._observers.forEach(i=>i.next(this.state));if(this.devTools){this.devTools.send(s,this.state)}return true}});this.reducers={};this.middlewares=[];this.devTools=this._connectToDevTools();Object.keys(e).forEach(t=>{if(typeof e[t]==="function"){this.register(t,e[t])}else{this.state[t]=e[t]}})}_applyMiddleware(e,...t){const s={state:this.state,action:e,payload:t};for(const n of this.middlewares){n(s)}}_connectToDevTools(){if(typeof window!=="undefined"&&window["__REDUX_DEVTOOLS_EXTENSION__"]){const e=window["__REDUX_DEVTOOLS_EXTENSION__"].connect();e.init(this.state);return e}return null}use(e){this.middlewares.push(e)}register(e,t){if(this.reducers[e]){throw new Error(`[Cami.js] Action type ${e} is already registered.`)}this.reducers[e]=t;this[e]=(...s)=>{this.dispatch(e,...s)}}dispatch(e,t){if(typeof e==="function"){return e(this.dispatch.bind(this),()=>this.state)}if(typeof e!=="string"){throw new Error(`[Cami.js] Action type must be a string. Got: ${typeof e}`)}const s=this.reducers[e];if(!s){console.warn(`No reducer found for action ${e}`);return}this._applyMiddleware(e,t);this.state=U(this.state,n=>{s(n,t)});this._observers.forEach(n=>n.next(this.state));if(this.devTools){this.devTools.send(e,this.state)}}};var qt=r=>{return(e,t)=>{const s=(t==null?void 0:t.name)||"default-store";const n=(t==null?void 0:t.load)!==false;const i=24*60*60*1e3;const o=(t==null?void 0:t.expiry)!==void 0?t.expiry:i;const a=new r(e);a.init=()=>{if(n){const c=localStorage.getItem(s);const u=localStorage.getItem(`${s}-expiry`);const f=new Date().getTime();if(c&&u){const l=f>=parseInt(u,10);if(!l){a.state=JSON.parse(c)}else{localStorage.removeItem(s);localStorage.removeItem(`${s}-expiry`)}}}};a.init();a.reset=()=>{localStorage.removeItem(s);localStorage.removeItem(`${s}-expiry`);a.state=e;a._observers.forEach(c=>c.next(a.state))};a.subscribe(c=>{const u=new Date().getTime();const f=u+o;localStorage.setItem(s,JSON.stringify(c));localStorage.setItem(`${s}-expiry`,f.toString())});return a}};var Wt=(r,e={})=>{const t={localStorage:true,name:"cami-store",expiry:864e5};const s=C(C({},t),e);if(s.localStorage){const n=qt(k)(r,s);return n}else{return new k(r)}};var A=class r extends g{static from(e){if(e instanceof g){return new r(t=>{const s=e.subscribe({next:n=>t.next(n),error:n=>t.error(n),complete:()=>t.complete()});return()=>{if(!s.closed){s.unsubscribe()}}})}else if(e[Symbol.asyncIterator]){return new r(t=>{let s=false;(()=>R(this,null,function*(){try{try{for(var n=de(e),i,o,a;i=!(o=yield n.next()).done;i=false){const c=o.value;if(s)return;t.next(c)}}catch(o){a=[o]}finally{try{i&&(o=n.return)&&(yield o.call(n))}finally{if(a)throw a[0]}}t.complete()}catch(c){t.error(c)}}))();return()=>{s=true}})}else if(e[Symbol.iterator]){return new r(t=>{try{for(const s of e){t.next(s)}t.complete()}catch(s){t.error(s)}return()=>{if(!subscription.closed){subscription.unsubscribe()}}})}else if(e instanceof Promise){return new r(t=>{e.then(s=>{t.next(s);t.complete()},s=>t.error(s));return()=>{}})}else{throw new TypeError("[Cami.js] ObservableStream.from requires an Observable, AsyncIterable, Iterable, or Promise")}}map(e){return new r(t=>{const s=this.subscribe({next:n=>t.next(e(n)),error:n=>t.error(n),complete:()=>t.complete()});return()=>s.unsubscribe()})}filter(e){return new r(t=>{const s=this.subscribe({next:n=>{if(e(n)){t.next(n)}},error:n=>t.error(n),complete:()=>t.complete()});return()=>s.unsubscribe()})}reduce(e,t){return new Promise((s,n)=>{let i=t;const o=this.subscribe({next:a=>{i=e(i,a)},error:a=>n(a),complete:()=>s(i)});return()=>o.unsubscribe()})}takeUntil(e){return new r(t=>{const s=this.subscribe({next:i=>t.next(i),error:i=>t.error(i),complete:()=>t.complete()});const n=e.subscribe({next:()=>{t.complete();s.unsubscribe();n.unsubscribe()},error:i=>t.error(i)});return()=>{s.unsubscribe();n.unsubscribe()}})}take(e){return new r(t=>{let s=0;const n=this.subscribe({next:i=>{if(s++<e){t.next(i)}else{t.complete();n.unsubscribe()}},error:i=>t.error(i),complete:()=>t.complete()});return()=>n.unsubscribe()})}drop(e){return new r(t=>{let s=0;const n=this.subscribe({next:i=>{if(s++>=e){t.next(i)}},error:i=>t.error(i),complete:()=>t.complete()});return()=>n.unsubscribe()})}flatMap(e){return new r(t=>{const s=new Set;const n=this.subscribe({next:i=>{const o=e(i);const a=o.subscribe({next:c=>t.next(c),error:c=>t.error(c),complete:()=>{s.delete(a);if(s.size===0){t.complete()}}});s.add(a)},error:i=>t.error(i),complete:()=>{if(s.size===0){t.complete()}}});return()=>{n.unsubscribe();s.forEach(i=>i.unsubscribe())}})}switchMap(e){return new r(t=>{let s=null;const n=this.subscribe({next:i=>{if(s){s.unsubscribe()}const o=e(i);s=o.subscribe({next:a=>t.next(a),error:a=>t.error(a),complete:()=>{if(s){s.unsubscribe();s=null}}})},error:i=>t.error(i),complete:()=>{if(s){s.unsubscribe()}t.complete()}});return()=>{n.unsubscribe();if(s){s.unsubscribe()}}})}toArray(){return new Promise((e,t)=>{const s=[];this.subscribe({next:n=>s.push(n),error:n=>t(n),complete:()=>e(s)})})}forEach(e){return new Promise((t,s)=>{this.subscribe({next:n=>e(n),error:n=>s(n),complete:()=>t()})})}every(e){return new Promise((t,s)=>{let n=true;this.subscribe({next:i=>{if(!e(i)){n=false;t(false)}},error:i=>s(i),complete:()=>t(n)})})}find(e){return new Promise((t,s)=>{const n=this.subscribe({next:i=>{if(e(i)){t(i);n.unsubscribe()}},error:i=>s(i),complete:()=>t(void 0)})})}some(e){return new Promise((t,s)=>{const n=this.subscribe({next:i=>{if(e(i)){t(true);n.unsubscribe()}},error:i=>s(i),complete:()=>t(false)})})}finally(e){return new r(t=>{const s=this.subscribe({next:n=>t.next(n),error:n=>{e();t.error(n)},complete:()=>{e();t.complete()}});return()=>{s.unsubscribe()}})}toState(e=null){const t=new x(e,null,{name:"ObservableStream"});this.subscribe({next:s=>t.update(()=>s),error:s=>t.error(s),complete:()=>t.complete()});return t}push(e){if(e instanceof g){const t=e.subscribe({next:s=>this._observers.forEach(n=>n.next(s)),error:s=>this._observers.forEach(n=>n.error(s)),complete:()=>this._observers.forEach(s=>s.complete())})}else if(e[Symbol.asyncIterator]){(()=>R(this,null,function*(){try{try{for(var t=de(e),s,n,i;s=!(n=yield t.next()).done;s=false){const o=n.value;this._observers.forEach(a=>a.next(o))}}catch(n){i=[n]}finally{try{s&&(n=t.return)&&(yield n.call(t))}finally{if(i)throw i[0]}}this._observers.forEach(o=>o.complete())}catch(o){this._observers.forEach(a=>a.error(o))}}))()}else if(e[Symbol.iterator]){try{for(const t of e){this._observers.forEach(s=>s.next(t))}this._observers.forEach(t=>t.complete())}catch(t){this._observers.forEach(s=>s.error(t))}}else if(e instanceof Promise){e.then(t=>{this._observers.forEach(s=>s.next(t));this._observers.forEach(s=>s.complete())},t=>this._observers.forEach(s=>s.error(t)))}else{this._observers.forEach(t=>t.next(e))}}plug(e){e.subscribe({next:t=>this.push(t),error:t=>this._observers.forEach(s=>s.error(t)),complete:()=>this._observers.forEach(t=>t.complete())})}end(){this._observers.forEach(e=>{if(e&&typeof e.complete==="function"){e.complete()}})}catchError(e){return new r(t=>{const s=this.subscribe({next:n=>t.next(n),error:n=>{const i=e(n);i.subscribe({next:o=>t.next(o),error:o=>t.error(o),complete:()=>t.complete()})},complete:()=>t.complete()});return()=>s.unsubscribe()})}debounce(e){return new r(t=>{let s=null;const n=this.subscribe({next:i=>{clearTimeout(s);s=setTimeout(()=>{t.next(i)},e)},error:i=>t.error(i),complete:()=>{clearTimeout(s);t.complete()}});return()=>{clearTimeout(s);n.unsubscribe()}})}tap(e){return new r(t=>{const s=this.subscribe({next:n=>{e(n);t.next(n)},error:n=>t.error(n),complete:()=>t.complete()});return()=>s.unsubscribe()})}throttle(e){return new r(t=>{let s=0;const n=this.subscribe({next:i=>{const o=Date.now();if(o-s>e){s=o;t.next(i)}},error:i=>t.error(i),complete:()=>t.complete()});return()=>n.unsubscribe()})}distinctUntilChanged(){return new r(e=>{let t;let s=true;const n=this.subscribe({next:i=>{if(s||i!==t){s=false;t=i;e.next(i)}},error:i=>e.error(i),complete:()=>e.complete()});return()=>n.unsubscribe()})}concatMap(e){return new r(t=>{let s=null;let n=false;const i=[];const o=this.subscribe({next:a=>{if(!n){n=true;const c=e(a);s=c.subscribe({next:u=>t.next(u),error:u=>t.error(u),complete:()=>{if(i.length>0){const u=i.shift();const f=e(u);s=f.subscribe({next:l=>t.next(l),error:l=>t.error(l),complete:()=>n=false})}else{n=false}}})}else{i.push(a)}},error:a=>t.error(a),complete:()=>{if(!n){t.complete()}}});return()=>{o.unsubscribe();if(s){s.unsubscribe()}}})}combineLatest(...e){return new r(t=>{const s=new Array(e.length).fill(void 0);const n=e.map((i,o)=>i.subscribe({next:a=>{s[o]=a;if(!s.includes(void 0)){t.next([...s])}},error:a=>t.error(a),complete:()=>{}}));return()=>n.forEach(i=>i.unsubscribe())})}startWith(...e){return new r(t=>{e.forEach(n=>t.next(n));const s=this.subscribe({next:n=>t.next(n),error:n=>t.error(n),complete:()=>t.complete()});return()=>s.unsubscribe()})}};var B={events:{_state:true,get isEnabled(){return this._state},enable:function(){this._state=true},disable:function(){this._state=false}},debug:{_state:false,get isEnabled(){return this._state},enable:function(){console.log("Cami.js debug mode enabled");this._state=true},disable:function(){this._state=false}}};function p(r,...e){if(B.debug.isEnabled){if(r==="cami:state:change"){console.groupCollapsed(`%c[${r}]`,"color: #666666; padding: 1px 3px; border: 1px solid #bbbbbb; border-radius: 2px; font-size: 90%; display: inline-block;",`${e[0]} changed`);console.log(`oldValue:`,e[1]);console.log(`newValue:`,e[2])}else{console.groupCollapsed(`%c[${r}]`,"color: #666666; padding: 1px 3px; border: 1px solid #bbbbbb; border-radius: 2px; font-size: 90%; display: inline-block;",...e)}console.trace();console.groupEnd()}}var j={current:null};var x=class extends g{constructor(e=null,t=null,{last:s=false,name:n=null}={}){super();if(s){this._lastObserver=t}else{this._observers.push(t)}this._value=U(e,i=>{});this._pendingUpdates=[];this._updateScheduled=false;this._name=n}get value(){if(j.current!=null){j.current.addDependency(this)}return this._value}set value(e){this.update(()=>e)}assign(e){if(typeof this._value!=="object"||this._value===null){throw new Error("[Cami.js] Observable value is not an object")}this.update(t=>Object.assign(t,e))}set(e,t){if(typeof this._value!=="object"||this._value===null){throw new Error("[Cami.js] Observable value is not an object")}this.update(s=>{const n=e.split(".");let i=s;for(let o=0;o<n.length-1;o++){i=i[n[o]]}i[n[n.length-1]]=t})}delete(e){if(typeof this._value!=="object"||this._value===null){throw new Error("[Cami.js] Observable value is not an object")}this.update(t=>{const s=e.split(".");let n=t;for(let i=0;i<s.length-1;i++){n=n[s[i]]}delete n[s[s.length-1]]})}clear(){this.update(()=>({}))}push(...e){if(!Array.isArray(this._value)){throw new Error("[Cami.js] Observable value is not an array")}this.update(t=>{t.push(...e)})}pop(){if(!Array.isArray(this._value)){throw new Error("[Cami.js] Observable value is not an array")}this.update(e=>{e.pop()})}shift(){if(!Array.isArray(this._value)){throw new Error("[Cami.js] Observable value is not an array")}this.update(e=>{e.shift()})}splice(e,t,...s){if(!Array.isArray(this._value)){throw new Error("[Cami.js] Observable value is not an array")}this.update(n=>{n.splice(e,t,...s)})}unshift(...e){if(!Array.isArray(this._value)){throw new Error("[Cami.js] Observable value is not an array")}this.update(t=>{t.unshift(...e)})}reverse(){if(!Array.isArray(this._value)){throw new Error("[Cami.js] Observable value is not an array")}this.update(e=>{e.reverse()})}sort(e){if(!Array.isArray(this._value)){throw new Error("[Cami.js] Observable value is not an array")}this.update(t=>{t.sort(e)})}fill(e,t=0,s=this._value.length){if(!Array.isArray(this._value)){throw new Error("[Cami.js] Observable value is not an array")}this.update(n=>{n.fill(e,t,s)})}copyWithin(e,t,s=this._value.length){if(!Array.isArray(this._value)){throw new Error("[Cami.js] Observable value is not an array")}this.update(n=>{n.copyWithin(e,t,s)})}update(e){this._pendingUpdates.push(e);this._scheduleupdate()}_scheduleupdate(){if(!this._updateScheduled){this._updateScheduled=true;this._applyUpdates()}}_notifyObservers(){const e=[...this._observers,this._lastObserver];e.forEach(t=>{if(t&&typeof t==="function"){t(this._value)}else if(t&&t.next){t.next(this._value)}})}_applyUpdates(){let e=this._value;while(this._pendingUpdates.length>0){const t=this._pendingUpdates.shift();if(typeof this._value==="object"&&this._value!==null&&this._value.constructor===Object||Array.isArray(this._value)){this._value=U(this._value,t)}else{this._value=t(this._value)}}if(e!==this._value){this._notifyObservers();if(B.events.isEnabled&&typeof window!=="undefined"){const t=new CustomEvent("cami:state:change",{detail:{name:this._name,oldValue:e,newValue:this._value}});window.dispatchEvent(t)}p("cami:state:change",this._name,e,this._value)}this._updateScheduled=false}toStream(){const e=new A;this.subscribe({next:t=>e.emit(t),error:t=>e.error(t),complete:()=>e.end()});return e}complete(){this._observers.forEach(e=>{if(e&&typeof e.complete==="function"){e.complete()}})}};var Ie=class extends x{constructor(e){super(null);this.computeFn=e;this.dependencies=new Set;this.subscriptions=new Map;this._compute()}get value(){if(j.current){j.current.addDependency(this)}return this._value}_compute(){const e={addDependency:s=>{if(!this.dependencies.has(s)){const n=s.onValue(()=>this._compute());this.dependencies.add(s);this.subscriptions.set(s,n)}}};j.current=e;const t=this.computeFn();j.current=null;if(t!==this._value){this._value=t;this._notifyObservers()}}dispose(){this.subscriptions.forEach(e=>{e.unsubscribe()})}};var ze=function(r){return new Ie(r)};var Fe=function(r){let e=()=>{};let t=new Set;let s=new Map;const n={addDependency:a=>{if(!t.has(a)){const c=a.onValue(i);t.add(a);s.set(a,c)}}};const i=()=>{e();j.current=n;e=r()||(()=>{});j.current=null};if(typeof window!=="undefined"){requestAnimationFrame(i)}else{setTimeout(i,0)}const o=()=>{s.forEach(a=>{a.unsubscribe()});e()};return o};var E=new Map;var He=class extends HTMLElement{constructor(){super();this.onCreate();this._unsubscribers=new Map;this._computed=ze.bind(this);this.effect=Fe.bind(this);this._queryFunctions=new Map}observableAttributes(e){Object.entries(e).forEach(([t,s])=>{let n=this.getAttribute(t);const i=typeof s==="function"?s:a=>a;n=U(n,i);const o=this._observable(n,t);if(this._isObjectOrArray(o.value)){this._createObservablePropertyForObjOrArr(this,t,o,true)}else{this._createObservablePropertyForPrimitive(this,t,o,true)}})}_computed(e){const t=super._computed(e);console.log(t);this._registerObservables(t);return t}effect(e){const t=super.effect(e);this._unsubscribers.set(e,t)}connect(e,t){if(!(e instanceof k)){throw new TypeError("Expected store to be an instance of ObservableStore")}const s=this._observable(e.state[t],t);const n=e.subscribe(i=>{s.update(()=>i[t])});this._unsubscribers.set(t,n);if(this._isObjectOrArray(s.value)){return this._observableProxy(s)}else{return new Proxy(s,{get:()=>s.value,set:(i,o,a)=>{if(o==="value"){s.update(()=>a)}else{i[o]=a}return true}})}}stream(e){return new A(e)}template(){throw new Error("[Cami.js] You have to implement the method template()!")}query({queryKey:e,queryFn:t,staleTime:s=0,refetchOnWindowFocus:n=true,refetchOnMount:i=true,refetchOnReconnect:o=true,refetchInterval:a=null,gcTime:c=1e3*60*5,retry:u=3,retryDelay:f=l=>Math.pow(2,l)*1e3}){const l=Array.isArray(e)?e.map(w=>typeof w==="object"?JSON.stringify(w):w).join(":"):e;this._queryFunctions.set(l,t);p("query","Starting query with key:",l);const h=this._observable({data:null,status:"pending",fetchStatus:"idle",error:null,lastUpdated:E.has(l)?E.get(l).lastUpdated:null},l);const _=this._observableProxy(h);const $=(w=0)=>R(this,null,function*(){const ke=Date.now();const fe=E.get(l);if(fe&&ke-fe.lastUpdated<s){p("fetchData (if)","Using cached data for key:",l);h.update(O=>{O.data=fe.data;O.status="success";O.fetchStatus="idle"})}else{p("fetchData (else)","Fetching data for key:",l);try{h.update(S=>{S.status="pending";S.fetchStatus="fetching"});const O=yield t();E.set(l,{data:O,lastUpdated:ke});h.update(S=>{S.data=O;S.status="success";S.fetchStatus="idle"})}catch(O){p("fetchData (catch)","Fetch error for key:",l,O);if(w<u){setTimeout(()=>$(w+1),f(w))}else{h.update(S=>{S.error={message:O.message};S.status="error";S.fetchStatus="idle"})}}}});if(i){p("query","Setting up refetch on mount for key:",l);$()}if(n){p("query","Setting up refetch on window focus for key:",l);const w=()=>$();window.addEventListener("focus",w);this._unsubscribers.set(`focus:${l}`,()=>window.removeEventListener("focus",w))}if(o){p("query","Setting up refetch on reconnect for key:",l);window.addEventListener("online",$);this._unsubscribers.set(`online:${l}`,()=>window.removeEventListener("online",$))}if(a){p("query","Setting up refetch interval for key:",l);const w=setInterval($,a);this._unsubscribers.set(`interval:${l}`,()=>clearInterval(w))}const bt=setTimeout(()=>{E.delete(l)},c);this._unsubscribers.set(`gc:${l}`,()=>clearTimeout(bt));return _}mutation({mutationFn:e,onMutate:t,onError:s,onSuccess:n,onSettled:i}){const o=this._observable({data:null,status:"idle",error:null,isSettled:false},"mutation");const a=this._observableProxy(o);const c=u=>R(this,null,function*(){p("mutation","Starting mutation for variables:",u);let f;const l=o.value;if(t){p("mutation","Performing optimistic update for variables:",u);f=t(u,l);o.update(h=>{h.data=f.optimisticData;h.status="pending";h.error=null})}else{p("mutation","Performing mutation without optimistic update for variables:",u);o.update(h=>{h.status="pending";h.error=null})}try{const h=yield e(u);o.update(_=>{_.data=h;_.status="success"});if(n){n(h,u,f)}p("mutation","Mutation successful for variables:",u,h)}catch(h){p("mutation","Mutation error for variables:",u,h);o.update(_=>{_.error={message:h.message};_.status="error";if(!s&&f&&f.rollback){p("mutation","Rolling back mutation for variables:",u);f.rollback()}});if(s){s(h,u,f)}}finally{if(!o.value.isSettled){o.update(h=>{h.isSettled=true});if(i){p("mutation","Calling onSettled for variables:",u);i(o.value.data,o.value.error,u,f)}}}});a.mutate=c;a.reset=()=>{o.update(u=>{u.data=null;u.status="idle";u.error=null;u.isSettled=false})};return a}invalidateQueries(e){const t=Array.isArray(e)?e.join(":"):e;p("invalidateQueries","Invalidating query with key:",t);E.delete(t);this._refetchQuery(t)}onCreate(){}connectedCallback(){this._setup({infer:true});this.effect(()=>this._react());this.onConnect()}onConnect(){}disconnectedCallback(){this.onDisconnect();this._unsubscribers.forEach(e=>e())}onDisconnect(){}attributeChangedCallback(e,t,s){this.onAttributeChange(e,t,s)}onAttributeChange(e,t,s){}adoptedCallback(){this.onAdopt()}onAdopt(){}_isObjectOrArray(e){return e!==null&&(typeof e==="object"||Array.isArray(e))}_createObservablePropertyForObjOrArr(e,t,s,n=false){if(!(s instanceof x)){throw new TypeError("Expected observable to be an instance of ObservableState")}const i=this._observableProxy(s);Object.defineProperty(e,t,{get:()=>i,set:o=>{s.update(()=>o);if(n){this.setAttribute(t,o)}}})}_createObservablePropertyForPrimitive(e,t,s,n=false){if(!(s instanceof x)){throw new TypeError("Expected observable to be an instance of ObservableState")}Object.defineProperty(e,t,{get:()=>s.value,set:i=>{s.update(()=>i);if(n){this.setAttribute(t,i)}}})}_observableProxy(e){if(!(e instanceof x)){throw new TypeError("Expected observable to be an instance of ObservableState")}return new Proxy(e,{get:(t,s)=>{if(typeof t[s]==="function"){return t[s].bind(t)}else if(s in t){return t[s]}else if(typeof t.value[s]==="function"){return(...n)=>t.value[s](...n)}else{return t.value[s]}},set:(t,s,n)=>{t[s]=n;t.update(()=>t.value);return true}})}_setup(e){if(e.infer===true){Object.keys(this).forEach(t=>{if(typeof this[t]!=="function"&&!t.startsWith("_")){if(this[t]instanceof g){return}else{const s=this._observable(this[t],t);if(this._isObjectOrArray(s.value)){this._createObservablePropertyForObjOrArr(this,t,s)}else{this._createObservablePropertyForPrimitive(this,t,s)}}}})}}_observable(e,t=null){if(!this._isAllowedType(e)){const n=Object.prototype.toString.call(e);throw new Error(`[Cami.js] The type ${n} of initialValue is not allowed in observables.`)}const s=new x(e);this._registerObservables(s);return s}_refetchQuery(e){p("_refetchQuery","Refetching query with key:",e);const t=this._queryFunctions.get(e);if(t){p("_refetchQuery","Found query function for key:",e);const s=E.get(e)||{data:void 0,status:"idle",error:null};E.set(e,pe(C({},s),{status:"pending",error:null}));t().then(n=>{E.set(e,{data:n,status:"success",error:null,lastUpdated:Date.now()});p("_refetchQuery","Refetch successful for key:",e,n)}).catch(n=>{if(s.data!==void 0){p("_refetchQuery","Rolling back refetch for key:",e);E.set(e,s)}E.set(e,pe(C({},s),{status:"error",error:n}))}).finally(()=>{this.query({queryKey:e,queryFn:t});p("_refetchQuery","Refetch complete for key:",e)})}}_isAllowedType(e){const t=["number","string","boolean","object","undefined"];const s=typeof e;if(s==="object"){return e===null||Array.isArray(e)||this._isPlainObject(e)}return t.includes(s)}_isPlainObject(e){if(Object.prototype.toString.call(e)!=="[object Object]"){return false}const t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}_registerObservables(e){if(!(e instanceof x)){throw new TypeError("Expected observableState to be an instance of ObservableState")}this._unsubscribers.set(e,()=>{if(typeof e.dispose==="function"){e.dispose()}})}_react(){const e=this.template();Ae(e,this)}};var Ue=class extends A{constructor(e){super();if(typeof e==="string"){this.element=document.querySelector(e);if(!this.element){throw new Error(`[Cami.js] Element not found for selector: ${e}`)}}else if(e instanceof Element||e instanceof Document){this.element=e}else{throw new Error(`[Cami.js] Invalid argument: ${e}`)}}on(e,t={}){return new A(s=>{const n=i=>{s.next(i)};this.element.addEventListener(e,n,t);return()=>{this.element.removeEventListener(e,n,t)}})}};var le=class extends A{constructor(){super(...arguments);Ve(this,"_handlers",{})}toJson(){return new Promise((t,s)=>{this.subscribe({next:n=>{try{if(typeof n==="object"){t(n)}else{t(JSON.parse(n))}}catch(i){s(i)}},error:n=>s(n)})})}on(t,s){if(!this._handlers[t]){this._handlers[t]=[]}this._handlers[t].push(s);return this}};var v=r=>{if(typeof r==="string"){return v.get(r)}return new le(e=>{const t=new XMLHttpRequest;t.open(r.method||"GET",r.url);if(r.headers){Object.keys(r.headers).forEach(s=>{t.setRequestHeader(s,r.headers[s])})}t.onload=()=>{let s=t.responseText;const n=r.transformResponse||(i=>{try{return JSON.parse(i)}catch(o){return i}});s=n(s);e.next(s);e.complete()};t.onerror=()=>e.error(t.statusText);t.send(r.data?JSON.stringify(r.data):null);return()=>{t.abort()}})};v.get=(r,e={})=>{e.url=r;e.method="GET";return v(e)};v.post=(r,e={},t={})=>{t.url=r;t.data=e;t.method="POST";return v(t)};v.put=(r,e={},t={})=>{t.url=r;t.data=e;t.method="PUT";return v(t)};v.patch=(r,e={},t={})=>{t.url=r;t.data=e;t.method="PATCH";return v(t)};v.delete=(r,e={})=>{e.url=r;e.method="DELETE";return v(e)};v.sse=(r,e={})=>{const t=new le(s=>{const n=new EventSource(r,e);n.onmessage=i=>{if(t._handlers[i.type]){t._handlers[i.type].forEach(o=>o(i))}s.next(i)};n.onerror=i=>s.error(i);return()=>{n.close()}});return t};var{debug:Xr,events:Gr}=B;export{g as Observable,Ue as ObservableElement,x as ObservableState,k as ObservableStore,A as ObservableStream,He as ReactiveElement,ze as computed,xe as css,Xr as debug,Fe as effect,Gr as events,rt as html,v as http,Wt as store,Et as svg};
/**
 * @license
 * Copyright (c) 2023 Kenn Costales
 * MIT License
 */
/*! Bundled license information:

lit-html/lit-html.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)
*/
//# sourceMappingURL=cami.module.js.map
