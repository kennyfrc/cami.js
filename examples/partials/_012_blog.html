<article>
  <h1>Blog</h1>
  <blog-component></blog-component>
</article>
<script src="./build/cami.cdn.js"></script>
<!-- CDN version below -->
<!-- <script src="https://unpkg.com/cami@latest/build/cami.cdn.js"></script> -->
<script type="module">
 const { html, ReactiveElement } = cami;

  class BlogComponent extends ReactiveElement {
    posts = {}

    constructor() {
      super();
      this.define({
        observables: ['posts'],
      });
    }

    connectedCallback() {
      super.connectedCallback();
      this.posts = this.query({
        queryKey: ["posts"],
        queryFn: () => fetch("https://jsonplaceholder.typicode.com/posts").then(posts => posts.json())
      });
    }

    template() {
      if (this.posts.isLoading) {
        return html`<div>Loading...</div>`;
      }

      if (this.posts.error) {
        return html`<div>Error: ${this.posts.error.message}</div>`;
      }

      if (this.posts.data) {
        return html`
          <ul>
            ${this.posts.data.map(post => html`
              <li>
                <h2>${post.title}</h2>
                <p>${post.body}</p>
              </li>
            `)}
          </ul>
        `;
      }
    }
  }

  customElements.define('blog-component', BlogComponent);

</script>
